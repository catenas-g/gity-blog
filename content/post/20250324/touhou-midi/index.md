---
title: 東方Projectの音楽をSC-88ST Proで聴ける環境を構築した話
description: 昔のゲームはMIDIで音楽を鳴らしていました。そういった音楽を当時の音源で聴こうとすると、実は大変なのです。
slug: sc-88st-pro
date: 2025-03-23T20:51:12+09:00
image: playing-th06.png
draft: false
hidden: false
categories:
  - IT技術
tags:
  - ゲーム
  - レトロPC
  - 変
authors: 
  - 山田ハヤオ
---

こんにちは、山田ハヤオです。

皆さんは東方projectというものをご存知でしょうか？

1996年から続く弾幕シューティングゲームのシリーズのことなのですが、私はそのゲームの音楽が大好きです。

ということで今回は、GITYでこのゲームの音楽を聞いていきます。

## MIDIとは

音楽をやっている方はご存知だと思いますが、昔から存在する音楽形式にMIDIというものがあります。

mp3やwav等の音楽形式は「音声データそのもの」を持っていますが、MIDIは「演奏する方法」を持っているデータ形式です。

MIDIは「どこの鍵盤を何秒押すのか」という情報しか持っていないため、それを鳴らすための音源が必要になります。

## SC-88STPro

現代ではMIDIの音源にはソフトウェアを使うことが大半ですが、かつては**ハードウェアMIDI音源**という、MIDIを鳴らすための専用の器械がありました。

東方Projectの初期の頃のゲームもこのハードウェア音源が無いと当時の音を再生することができません。

ということでヤフオクで入手したのがこちらですドン！

![SC-88ST Pro](sc-88st-pro.png)

入手してしまいました。**SC-88ST Pro**です。

東方Project作品の推奨音源はSC-88Proです。SC-88ST ProはSC-88Proと音源として完全な互換性があります。違いは液晶の有無で、所謂廉価版というやつです。

このSC-88ST Proを鳴らしていこうと思います。

## 音を鳴らす

今回は16音色の構成です。いつか32音構成もやってみたいところですが、MIDIインターフェースを1つしか持っておらず、2系統のものは高価なので暫く先の話になりそうです。

### 構成

- SC-88ST Pro
- LEKATO USB MIDI Interface
  Amazonで2,000円でした
- Windowsが動作しているPC
  WindowsVista以前が用意できると安定します
- 3.5mmジャックを備えた有線イヤホン

PCとMIDI InterfaceをUSBで接続します。ドライバは自動でインストールされました。

MIDI InterfaceのMIDI OutとSC-88ST ProのMIDI Inを接続します。

最後にSc-88ST Proのフロントの3.5mmイヤホンジャックにイヤホンを挿せば配線は完了です。

### 必要なソフトウェア

- 音を鳴らすゲーム・MIDI再生ソフトウェア
  今回は東方紅魔郷を再生します
- CoolSoft MIDIMapper

### MIDI Mapperについて

Windows XPまでのWindows OSには規定のMIDIデバイスを設定するMIDI Mapperという機能がありました。

しかしこの機能はWindows Vistaで廃止されています。
この問題は東方ProjectのようなMIDIの再生デバイスを指定できないゲームにおいて致命的です。

そこで利用するのが`CoolSoft MIDIMapper`です。仮想的なMIDIデバイスを作成・リダイレクトすることで任意のMIDIデバイスを規定の出力先に変更できるツールです。

以下の公式サイトからダウンロード・インストールが可能です。

[MIDIMapper \| CoolSoft](https://coolsoft.altervista.org/en/midimapper)

### 東方紅魔郷

東方紅魔郷は前述した東方Projectの第6作品目の弾幕型シューティングゲームです。Windowsで動作する東方Project作品の中で最古の作品です。

第1作から第5作は旧作と呼ばれ、現代のコンピュータ(PC/AT互換機)ではないPC-98シリーズでのみ動作します。

98シリーズの実機は現在入手困難なため、動作させるにはエミュレータを利用するのが主流ですが今回は割愛します。
(私の技量不足もあり、エミュレータから音を出せませんでした。)

第6作以降はWindowsで動作しますが、MIDIでの出力に対応しているのは第6作～第8作目のみ[^1]となります。それ以降の作品ではMIDIは非対応です。

また、東方紅魔郷にはWindows 10以降のOSで利用すると暴走するバグがありますが以下のDLLを導入することで回避しています。

[crosire/d3d8to9: A D3D8 pseudo\-driver which converts API calls and bytecode shaders to equivalent D3D9 ones\.](https://github.com/crosire/d3d8to9)

### 実際の様子

![東方紅魔郷をSC-88ST Proで再生する様子](playing-th06.png)

第8作品目である東方永夜抄でも再生してみました。

![東方永夜抄をSC-88ST Proで再生する様子](playing-th08.png)

## 音を収録する

オーディオインターフェースを利用してSC-88ST Proからの音を収録します。

今回はインターフェースとして**QX1002USB**を利用します。

### ケーブル配線

MIDI InterfaceとPCの接続に変化はありません。今まではイヤホンに出力していたものをインターフェースに流し込みます。

SC-88ST Proの裏にあるRCA出力からInterfaceに出力し、その音をAudacityで拾います。

このときのインターフェースやミキサの音量調整は、GITYにいる音楽系に詳しい先輩に行ってもらいました。

![収録をしている様子](audio-interface.png)

収録にあたって、安定動作のためにゲームを動作させる(MIDIを出力させる)PCと、Audacityを動作させるPCを分けることにしました。

奥にあるのはGITYでレガシーなソフトウェアを動作させるために私が持ち込んだWindows 7が動作しているノートPCです。

手前のPCにオーディオインターフェースを接続し、デジタル化された音をAudacityで録音しています。

## 終わり

**ハードウェアMIDI音源を聴けるシェアオフィスはGITYだけ**と言えるように環境を整えたいですね。  しかしそんなシェアオフィスの需要はあるのだろうか。

次回は東方Project発足当時のPCであるPC-98シリーズを分解し復活させようと思います。(失敗したらボツにします。)

[^1]: 正確には第9作品「東方花映塚」の体験版まで。旧作については知らないです。
